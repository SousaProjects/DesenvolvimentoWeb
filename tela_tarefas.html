<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organiza+</title>
    <link href="style-tarefas.css" rel="stylesheet">
    <link rel="icon" href="icone.ico">
    <script>
        function notificacao(){
            alert('O usuário foi desconectado!');
        }
    </script>
</head>
<body>

    <div class="ajustes">
        <img src="eu.jpg">
        <p>Olá Fabrício</p>
    </div>

    <div class="alterar-senha">
        <ion-icon name="key-outline"></ion-icon>
        <p id="alterar-senha">Alterar senha</p>
    </div>

    <div class="logoff">
        <a href="index.html" onclick="notificacao()">
            <p><ion-icon name="power-outline"></ion-icon>Sair</p>
        </a>
    </div>

    <iframe style="border-radius:12px" class="import-spotify" src="https://open.spotify.com/embed/playlist/7JabddFr3Q6JPsND4v9Swf?utm_source=generator&theme=0" width="350" height="152" frameBorder="0" allowfullscreen="" allow="play; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
    
    <main>
        <div class="img-logo"></div>
        <form class="add-tarefas">
            <input type="text" placeholder="Insira o nome da tarefa" class="input-tarefa">
            <button type="submit" href="#" id="btn-adicionar-tarefa">+</button>
        </form>
        <table>
            <thead class="cabeçalho">
                <tr>
                    <th style="width: 80px;">Criada em</th>
                    <th>Tarefa</th>
                    <th style="width: 120px;">Prazo</th>
                    <th style="width: 120px;">Status</th>
                    <th class="opcoes">Opções</th>
                </tr>
            </thead>

            <tbody>
                <tr>
                    <td>06/11/2023</td>
                    <td>Terminar site</td>
                    <td><input type="date" class="ent-data"></td>
                    <td>
                        <select>
                            <option value="pendente">Pendente</option>
                            <option value="em andamento">Em Andamento</option>
                            <option value="concluida">Concluída</option>
                        </select>
                    </td>
                    <td>
                        <button type="button" class="bt-opcoes" onclick="editarTarefa(this)"><ion-icon name="create-outline"></ion-icon></button>
                        <button type="button" class="bt-opcoes" onclick="excluirTarefa(this)"><ion-icon name="trash-outline"></ion-icon></button>
                    </td>
                </tr>
            </tbody>
        </table>
    </main>
</body>

<script>
    const alterarSenha = document.querySelector(".alterar-senha");
    const body = document.querySelector("body");

    alterarSenha.addEventListener("click", mostrarPopUp);

    function mostrarPopUp(event) {
        event.preventDefault();

        const popup = document.createElement("div");
        popup.classList.add("alterar-senha-completo");

        popup.innerHTML = `
            <div class="alterar-senha-cabecalho">
                <ion-icon name="key-outline"></ion-icon><p>Alterando sua senha</p><button type="button" id="fechar-popup">X</button>
            </div>
            <div class "alterar-senha-conteudo">
                <form>
                    <input type="password" placeholder="Senha Atual">
                    <input type="password" placeholder="Senha Nova">
                    <input type="password" placeholder="Confirme Nova Senha">
                    <button type="submit">Alterar Senha</button>
                </form>
            </div>
        `;

        body.appendChild(popup);

        const fecharPopup = document.getElementById("fechar-popup");
        fecharPopup.addEventListener("click", () => {
            body.removeChild(popup);
        });
    }

</script>

<script>
    const add = document.querySelector(".add-tarefas button");
    add.addEventListener("click", adicionarTarefa);

    function adicionarTarefa(event) {
        event.preventDefault();

        const tarefa = document.querySelector(".input-tarefa").value;

        if (tarefa.trim() == "") {
            alert("Insira o nome da tarefa.");
        } else {
            const tabelaTarefas = document.querySelector("table tbody");
            const novaLinha = tabelaTarefas.insertRow();

            const dataAtual = new Date().toLocaleDateString();
            const novaLinhaHtml = `
                <td>${dataAtual}</td>
                <td>${tarefa}</td>
                <td><input type="date" class="ent-data"></td>
                <td>
                    <select>
                        <option value="pendente">Pendente</option>
                        <option value="em andamento">Em Andamento</option>
                        <option value="concluida">Concluída</option>
                    </select>
                </td>
                <td>
                    <button type="button" class="bt-opcoes" onclick="editarTarefa(this)"><ion-icon name="create-outline"></ion-icon></button>
                    <button type="button" class="bt-opcoes" onclick="excluirTarefa(this)"><ion-icon name="trash-outline"></ion-icon></button>
                </td>
            `;

            novaLinha.innerHTML = novaLinhaHtml;
            document.querySelector(".input-tarefa").value = '';
            alert("Tarefa adicionada com sucesso!");

        
        }
    }
</script>

<script>

    function editarTarefa(botao) {
        const linha = botao.parentElement.parentElement;
        const colunaTarefa = linha.querySelector("td:nth-child(2)");
    
        // Verifica se a célula está editável
        if (colunaTarefa.classList.contains("editavel")) {
            colunaTarefa.contentEditable = false;
            colunaTarefa.classList.remove("editavel");
        } else {
            colunaTarefa.contentEditable = true;
            colunaTarefa.classList.add("editavel");
            colunaTarefa.focus();
    
            // Adiciona um evento de pressionar Enter para confirmar a edição
            colunaTarefa.addEventListener("keypress", function(e) {
                if (e.key === "Enter") {
                    e.preventDefault();
                    colunaTarefa.contentEditable = false;
                    colunaTarefa.classList.remove("editavel");
                }
            });
        }
    }
    
    var tabela = document.querySelector("table");
    if (tabela) {
        tabela.addEventListener("click", function(event) {
            if (event.target.tagName == "button") {
                editarTarefa(event.target);
            }
        });
    } else {
        console.log("A tabela não foi encontrada.");
    }
    

    function excluirTarefa(botao) {
        const linha = botao.parentElement.parentElement;
        linha.remove();
    }
</script>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</html>
